# ============================================================================
# ОСНОВНЫЕ НАСТРОЙКИ
# ============================================================================

# Prefix - меняем Ctrl+B (неудобный) на Ctrl+A
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# Нормальная нумерация окон (с 1, а не с 0)
set -g base-index 1
setw -g pane-base-index 1

# Автоматическая перенумерация окон
set -g renumber-windows on

# Увеличить историю
set -g history-limit 50000

# Быстрый ESC (для vim)
set -sg escape-time 0

# Включить мышь (для скролла и выбора панелей)
set -g mouse on

# Обновлять статус каждые 5 секунд
set -g status-interval 5

# 256 цветов
set -g default-terminal "screen-256color"
set -ga terminal-overrides ",xterm-256color:Tc"

# ============================================================================
# ГОРЯЧИЕ КЛАВИШИ
# ============================================================================

# Reload конфига
bind r source-file ~/.tmux.conf \; display "Config reloaded!"

# Создание панелей (более логичные клавиши)
bind | split-window -h -c "#{pane_current_path}"  # Вертикальный split
bind - split-window -v -c "#{pane_current_path}"  # Горизонтальный split
unbind '"'
unbind %

# Новое окно в текущей директории
bind c new-window -c "#{pane_current_path}"

# Переключение между панелями (vim-style)
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Изменение размера панелей
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Копирование в режиме vi
setw -g mode-keys vi
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy"
bind P paste-buffer
bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "pbcopy"

# Быстрое переключение между окнами
bind -n M-Left previous-window
bind -n M-Right next-window

# Kill panel без подтверждения
bind x kill-pane

# ============================================================================
# ВНЕШНИЙ ВИД (Tokyo Night тема)
# ============================================================================

# Цвета статус бара
set -g status-style bg=#1a1b26,fg=#c0caf5

# Левая часть статус бара
set -g status-left-length 40
set -g status-left "#[fg=#1a1b26,bg=#7aa2f7,bold] #S #[fg=#7aa2f7,bg=#1a1b26]"

# Правая часть статус бара
set -g status-right-length 80
set -g status-right "#[fg=#3b4261]#[fg=#c0caf5,bg=#3b4261] %d/%b/%Y #[fg=#7aa2f7]#[fg=#1a1b26,bg=#7aa2f7,bold] %H:%M "

# Стиль окон в статус баре
setw -g window-status-format "#[fg=#c0caf5] #I:#W "
setw -g window-status-current-format "#[fg=#1a1b26,bg=#bb9af7,bold] #I:#W "
setw -g window-status-separator ""

# Цвета панелей
set -g pane-border-style fg=#3b4261
set -g pane-active-border-style fg=#7aa2f7

# Цвета сообщений
set -g message-style bg=#7aa2f7,fg=#1a1b26

# ============================================================================
# ПЛАГИНЫ
# ============================================================================

# Tmux Plugin Manager
set -g @plugin 'tmux-plugins/tpm'

# Базовые настройки (sensible defaults)
set -g @plugin 'tmux-plugins/tmux-sensible'

# Сохранение сессий (автосохранение каждые 15 минут)
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @continuum-restore 'on'
set -g @continuum-save-interval '15'

# Копирование в системный буфер
set -g @plugin 'tmux-plugins/tmux-yank'

# Улучшенный поиск
set -g @plugin 'tmux-plugins/tmux-copycat'

# Открытие файлов/URL
set -g @plugin 'tmux-plugins/tmux-open'

# Быстрые переходы по тексту
set -g @plugin 'schasse/tmux-jump'

# FZF интеграция
set -g @plugin 'sainnhe/tmux-fzf'
TMUX_FZF_LAUNCH_KEY="C-f"

# ============================================================================
# ИНИЦИАЛИЗАЦИЯ TPM (должно быть в конце файла)
# ============================================================================
run '~/.tmux/plugins/tpm/tpm'
